{
    "name": "authenticity-loop",
    "steps": [
        {
            "step": "setState",
            "accounts": {
                "address:owner": {
                    "nonce": "1",
                    "balance": "0"
                },
                "address:agent": {
                    "nonce": "1",
                    "balance": "0"
                },
                "address:user": {
                    "nonce": "1",
                    "balance": "0"
                },
                "address:oracle": {
                    "nonce": "1",
                    "balance": "0"
                }
            },
            "newAddresses": [
                {
                    "creatorAddress": "address:owner",
                    "creatorNonce": "1",
                    "newAddress": "sc:identity"
                },
                {
                    "creatorAddress": "address:owner",
                    "creatorNonce": "2",
                    "newAddress": "sc:validation"
                },
                {
                    "creatorAddress": "address:owner",
                    "creatorNonce": "3",
                    "newAddress": "sc:reputation"
                }
            ]
        },
        {
            "step": "scDeploy",
            "txId": "deploy-id",
            "tx": {
                "from": "address:owner",
                "contractCode": "file:../identity-registry/output/identity-registry.wasm",
                "arguments": [],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0",
                "gas": "*",
                "refund": "*"
            }
        },
        {
            "step": "scDeploy",
            "txId": "deploy-val",
            "tx": {
                "from": "address:owner",
                "contractCode": "file:../validation-registry/output/validation-registry.wasm",
                "arguments": [],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0",
                "gas": "*",
                "refund": "*"
            }
        },
        {
            "step": "scDeploy",
            "txId": "deploy-rep",
            "tx": {
                "from": "address:owner",
                "contractCode": "file:../reputation-registry/output/reputation-registry.wasm",
                "arguments": [],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0",
                "gas": "*",
                "refund": "*"
            }
        },
        {
            "step": "scCall",
            "txId": "setup-rep",
            "tx": {
                "from": "address:owner",
                "to": "sc:reputation",
                "function": "validation_contract_address",
                "arguments": [
                    "sc:validation"
                ],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0",
                "gas": "*",
                "refund": "*"
            }
        },
        {
            "step": "scCall",
            "txId": "register-agent",
            "tx": {
                "from": "address:agent",
                "to": "sc:identity",
                "function": "register_agent",
                "arguments": [
                    "str:Moltbot-01",
                    "str:ipfs://manifest",
                    "str:pubkey"
                ],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0"
            }
        },
        {
            "step": "scCall",
            "txId": "init-job",
            "tx": {
                "from": "address:user",
                "to": "sc:validation",
                "function": "init_job",
                "arguments": [
                    "str:job_1",
                    "1"
                ],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0"
            }
        },
        {
            "step": "scCall",
            "txId": "submit-proof",
            "tx": {
                "from": "address:agent",
                "to": "sc:validation",
                "function": "submit_proof",
                "arguments": [
                    "str:job_1",
                    "str:proof_data"
                ],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0"
            }
        },
        {
            "step": "scCall",
            "txId": "verify-job",
            "tx": {
                "from": "address:oracle",
                "to": "sc:validation",
                "function": "verify_job",
                "arguments": [
                    "str:job_1"
                ],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0"
            }
        },
        {
            "step": "scCall",
            "txId": "authorize-feedback",
            "tx": {
                "from": "address:agent",
                "to": "sc:reputation",
                "function": "authorize_feedback",
                "arguments": [
                    "str:job_1",
                    "address:user"
                ],
                "gasLimit": "5,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0"
            }
        },
        {
            "step": "scCall",
            "txId": "submit-feedback",
            "tx": {
                "from": "address:user",
                "to": "sc:reputation",
                "function": "submit_feedback",
                "arguments": [
                    "str:job_1",
                    "1",
                    "5000"
                ],
                "gasLimit": "20,000,000",
                "gasPrice": "0"
            },
            "expect": {
                "status": "0"
            }
        },
        {
            "step": "checkState",
            "accounts": {
                "sc:reputation": {
                    "nonce": "0",
                    "balance": "0",
                    "storage": {
                        "str:reputationScore|u64:1": "5000",
                        "str:totalJobs|u64:1": "1",
                        "str:validationContractAddress": "sc:validation",
                        "str:isFeedbackAuthorized|str:job_1|address:user": "01",
                        "str:hasGivenFeedback|str:job_1": "01"
                    },
                    "code": "*"
                },
                "sc:validation": {
                    "nonce": "0",
                    "balance": "0",
                    "storage": {
                        "str:jobStatus|str:job_1": "01",
                        "str:jobProof|str:job_1": "str:proof_data",
                        "str:jobEmployer|str:job_1": "address:user",
                        "str:jobAgentNonce|str:job_1": "1",
                        "str:jobCreationTimestamp|str:job_1": "*"
                    },
                    "code": "*"
                },
                "+": ""
            }
        }
    ]
}